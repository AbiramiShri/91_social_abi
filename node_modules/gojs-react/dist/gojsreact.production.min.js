// Copyright (C) 1998-2020 by Northwoods Software Corporation. All Rights Reserved.
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("gojs"),require("react")):"function"==typeof define&&define.amd?define(["exports","gojs","react"],t):t((e=e||self).goJsReact={},e.go,e.React)}(this,(function(e,t,r){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(e){function n(t){var n=e.call(this,t)||this;return n.modelChangedListener=null,n.divRef=r.createRef(),n}return o(n,e),n.prototype.getDiagram=function(){return null===this.divRef.current?null:t.Diagram.fromDiv(this.divRef.current)},n.prototype.componentDidMount=function(){var e=this;if(null!==this.divRef.current){var r=this.props.initDiagram();r.div=this.divRef.current,this.modelChangedListener=function(t){if(t.isTransactionFinished){var r=t.model.toIncrementalData(t);null!==r&&e.props.onModelChange(r)}},r.addModelChangedListener(this.modelChangedListener),r.delayInitialization((function(){r.model.commit((function(r){r.mergeNodeDataArray(r.cloneDeep(e.props.nodeDataArray)),void 0!==e.props.linkDataArray&&r instanceof t.GraphLinksModel&&r.mergeLinkDataArray(r.cloneDeep(e.props.linkDataArray)),void 0!==e.props.modelData&&r.assignAllDataProperties(r.modelData,e.props.modelData)}),"gojs-react init merge")}))}},n.prototype.componentWillUnmount=function(){var e=this.getDiagram();null!==e&&(e.div=null,null!==this.modelChangedListener&&(e.removeModelChangedListener(this.modelChangedListener),this.modelChangedListener=null))},n.prototype.shouldComponentUpdate=function(e,t){return!e.skipsDiagramUpdate&&(e.nodeDataArray!==this.props.nodeDataArray||e.linkDataArray!==this.props.linkDataArray||e.modelData!==this.props.modelData)},n.prototype.componentDidUpdate=function(e,r){var n=this.getDiagram();if(null!==n){var o=n.model;o.startTransaction("update data"),o.mergeNodeDataArray(o.cloneDeep(this.props.nodeDataArray)),void 0!==this.props.linkDataArray&&o instanceof t.GraphLinksModel&&o.mergeLinkDataArray(o.cloneDeep(this.props.linkDataArray)),void 0!==this.props.modelData&&o.assignAllDataProperties(o.modelData,this.props.modelData),o.commitTransaction("update data")}},n.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},n}(r.Component),i=function(e){function n(t){var n=e.call(this,t)||this;return n.divRef=r.createRef(),n}return o(n,e),n.prototype.getOverview=function(){return null===this.divRef.current?null:t.Diagram.fromDiv(this.divRef.current)},n.prototype.componentDidMount=function(){var e;null!==this.divRef.current&&(void 0!==this.props.initOverview?e=this.props.initOverview():(e=new t.Overview).contentAlignment=t.Spot.Center,e.div=this.divRef.current,e.observed=this.props.observedDiagram)},n.prototype.componentWillUnmount=function(){var e=this.getOverview();null!==e&&(e.div=null,e.observed=null)},n.prototype.shouldComponentUpdate=function(e,t){return e.observedDiagram!==this.props.observedDiagram},n.prototype.componentDidUpdate=function(e,t){var r=this.getOverview();null!==r&&(r.observed=this.props.observedDiagram)},n.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},n}(r.Component),s=function(e){function n(t){var n=e.call(this,t)||this;return n.divRef=r.createRef(),n}return o(n,e),n.prototype.getPalette=function(){return null===this.divRef.current?null:t.Diagram.fromDiv(this.divRef.current)},n.prototype.componentDidMount=function(){var e=this;if(null!==this.divRef.current){var r=this.props.initPalette();r.div=this.divRef.current,r.delayInitialization((function(){r.model.commit((function(r){r.mergeNodeDataArray(r.cloneDeep(e.props.nodeDataArray)),void 0!==e.props.linkDataArray&&r instanceof t.GraphLinksModel&&r.mergeLinkDataArray(r.cloneDeep(e.props.linkDataArray)),void 0!==e.props.modelData&&r.assignAllDataProperties(r.modelData,e.props.modelData)}),null)}))}},n.prototype.componentWillUnmount=function(){var e=this.getPalette();null!==e&&(e.div=null)},n.prototype.shouldComponentUpdate=function(e,t){return e.nodeDataArray!==this.props.nodeDataArray||e.linkDataArray!==this.props.linkDataArray||e.modelData!==this.props.modelData},n.prototype.componentDidUpdate=function(e,r){var n=this.getPalette();if(null!==n){var o=n.model;o.startTransaction("update data"),o.mergeNodeDataArray(o.cloneDeep(this.props.nodeDataArray)),void 0!==this.props.linkDataArray&&o instanceof t.GraphLinksModel&&o.mergeLinkDataArray(o.cloneDeep(this.props.linkDataArray)),void 0!==this.props.modelData&&o.assignAllDataProperties(o.modelData,this.props.modelData),o.commitTransaction("update data")}},n.prototype.render=function(){return r.createElement("div",{ref:this.divRef,className:this.props.divClassName})},n}(r.Component);e.ReactDiagram=a,e.ReactOverview=i,e.ReactPalette=s,Object.defineProperty(e,"__esModule",{value:!0})}));
